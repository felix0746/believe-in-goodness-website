<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&family=Noto+Serif+TC:wght@600&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <link rel="stylesheet" href="style.css" />

  <title>我們的影響力｜相信善良｜解決社會問題，創造就業機會</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="了解「相信善良」如何正視偏鄉教育落差、育幼院離院生輔導及更生人融入社會等問題。我們預計培育萬名人才、連結百間機構，創造良善的社會循環。">
  <meta name="keywords" content="社會影響力, 社會問題, 偏鄉教育, 育幼院, 更生人, 就業機會, 人才培育, 相信善良">
  <meta name="author" content="相信善良">

  <!-- Favicon -->
  <link rel="icon" href="images/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
  <link rel="apple-touch-icon" href="images/logo.png">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://believe-in-kinnoess92eb6-e090a.web.app/impact.html">
  <meta property="og:title" content="我們的影響力｜相信善良｜解決社會問題，創造就業機會">
  <meta property="og:description" content="了解「相信善良」如何正視偏鄉教育落差、育幼院離院生輔導及更生人融入社會等問題。我們預計培育萬名人才、連結百間機構，創造良善的社會循環。">
  <meta property="og:image" content="https://believe-in-kinnoess92eb6-e090a.web.app/images/og-image-impact.jpg"> 

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://believe-in-kinnoess92eb6-e090a.web.app/impact.html">
  <meta property="twitter:title" content="我們的影響力｜相信善良｜解決社會問題，創造就業機會">
  <meta property="twitter:description" content="了解「相信善良」如何正視偏鄉教育落差、育幼院離院生輔導及更生人融入社會等問題。我們預計培育萬名人才、連結百間機構，創造良善的社會循環。">
  <meta property="twitter:image" content="https://believe-in-kinnoess92eb6-e090a.web.app/images/og-image-impact.jpg">


  <!-- Breadcrumb Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
      "@type": "ListItem",
      "position": 1,
      "name": "首頁",
      "item": "https://believe-in-kinnoess92eb6-e090a.web.app/index.html"
    },{
      "@type": "ListItem",
      "position": 2,
      "name": "我們的影響力",
      "item": "https://believe-in-kinnoess92eb6-e090a.web.app/impact.html"
    }]
  }
  </script>

  <!-- 引入 Firebase -->
  <script type="module">
    // 使用 Firebase Hosting 的保留 URL 載入 SDK
    import { initializeApp } from "/__/firebase/11.6.1/firebase-app.js";
    import { getFirestore, doc, onSnapshot } from "/__/firebase/11.6.1/firebase-firestore.js";

    // 更新頁面上的數字（帶有動畫效果）
    function updateNumbersOnPage(data) {
        animateValue(document.getElementById('talent-number'), 0, data.talent || 0, 1500);
        animateValue(document.getElementById('partners-number'), 0, data.partners || 0, 1500);
        animateValue(document.getElementById('jobs-number'), 0, data.jobs || 0, 1500);
    }
    
    // 數字滾動動畫函式
    function animateValue(obj, start, end, duration) {
      if (!obj) return;
      let startTimestamp = null;
      const step = (timestamp) => {
        if (!startTimestamp) startTimestamp = timestamp;
        const progress = Math.min((timestamp - startTimestamp) / duration, 1);
        obj.innerHTML = Math.floor(progress * (end - start) + start).toLocaleString();
        if (progress < 1) {
          window.requestAnimationFrame(step);
        }
  ***REMOVED***
      window.requestAnimationFrame(step);
    }

    // 異步初始化 Firebase 並監聽數據
    async function initializeAndListen() {
      try {
        // 從 Firebase Hosting 自動產生的設定檔中取得設定
        const response = await fetch('/__/firebase/init.json');
        const firebaseConfig = await response.json();
        
        // 使用獲取的設定初始化 Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // 監聽資料庫中的數字變化
        const docRef = doc(db, "impact", "numbers");
        onSnapshot(docRef, (doc) => {
            if (doc.exists()) {
                const data = doc.data();
                updateNumbersOnPage(data);
            } else {
                console.log("找不到影響力數字的資料！");
                // 如果找不到資料，顯示 0
                updateNumbersOnPage({ talent: 0, partners: 0, jobs: 0 });
            }
        }, (error) => {
            console.error("讀取影響力數字時發生錯誤:", error);
            // 發生錯誤時，也顯示 0
            updateNumbersOnPage({ talent: 0, partners: 0, jobs: 0 });
        });

      } catch (e) {
        console.error("Firebase 初始化失敗:", e);
        // 初始化失敗時，也顯示 0
        updateNumbersOnPage({ talent: 0, partners: 0, jobs: 0 });
      }
    }

    // 執行初始化
    initializeAndListen();
  </script>
</head>
<body>
  <header class="main-header" id="main-header">
    <div class="logo-container">
      <a href="index.html"><img src="images/相信善良-文字.png" alt="相信善良 logo" /></a>
    </div>

    <button class="mobile-nav-toggle" aria-controls="main-navigation" aria-expanded="false">
      <span class="sr-only">選單</span>
    </button>

    <nav>
      <ul id="main-navigation" class="main-nav" data-visible="false">
        <!-- 修改善良故事為下拉選單 -->
        <li class="dropdown" aria-expanded="false">
          <a href="#" class="nav-link" data-lang-key="navStory">善良故事 ▾</a>
          <ul class="dropdown-menu">
            <li><a href="story-messages.html" data-lang-key="navStoryMessages">善良訊息</a></li>
            <li><a href="story-news.html" data-lang-key="navStoryNews">善良快訊</a></li>
            <li><a href="story-milestones.html" data-lang-key="navStoryMilestones">里程碑</a></li>
          </ul>
        </li>
        <li><a href="impact.html" data-lang-key="navImpact">我們的影響力</a></li>
        <li class="dropdown" aria-expanded="false">
          <a href="#" class="nav-link" data-lang-key="navCare">關懷與溫暖 ▾</a>
          <ul class="dropdown-menu">
            <li><a href="care-domestic.html" data-lang-key="navCareDomestic">關懷與溫暖（國內）</a></li>
            <li><a href="care-international.html" data-lang-key="navCareInternational">關懷與溫暖（國外）</a></li>
          </ul>
        </li>
        <li><a href="contact.html" data-lang-key="navContact">聯繫我們</a></li>
        <li id="lang-switcher-container" class="lang-switcher-container"></li>
      </ul>
    </nav>
  </header>

  <main>
    <section class="page-intro fade-in-section">
      <h2 data-lang-key="impactMainTitle">我們的影響力</h2>
    </section>

    <section class="impact-content-section fade-in-section">
      <div class="problem-section">
        <div class="problem-text">
          <h3 data-lang-key="impactProblemsTitle">我們看見的問題</h3>
          <ul>
            <li data-lang-key="impactProblem1">偏鄉及原住民的孩教育資源的落差。</li>
            <li data-lang-key="impactProblem2">近7成從育幼院離開的學生無法順利繼續升學。</li>
            <li data-lang-key="impactProblem3">更生人無法重新融入社會。</li>
          </ul>
        </div>
        <div class="problem-image">
          <img src="images/child-looking-out.png" alt="一個孩子望向窗外">
        </div>
      </div>

      <div class="goals-section">
        <h3 data-lang-key="impactGoalsTitle">我們預計</h3>
        <div class="goals-grid">
          <div class="goal-item">
            <!-- 新增 id -->
            <span class="goal-number" id="talent-number">10,000</span>
            <span class="goal-label" data-lang-key="impactGoal1">培育人才</span>
            <span class="goal-unit" data-lang-key="impactUnitPeople">人</span>
          </div>
          <div class="goal-item">
            <!-- 新增 id -->
            <span class="goal-number" id="partners-number">100</span>
            <span class="goal-label" data-lang-key="impactGoal2">合作單位與機構</span>
            <span class="goal-unit" data-lang-key="impactUnitOrganizations">間</span>
          </div>
          <div class="goal-item">
            <!-- 新增 id -->
            <span class="goal-number" id="jobs-number">20,000</span>
            <span class="goal-label" data-lang-key="impactGoal3">創造餐飲就業機會</span>
            <span class="goal-unit" data-lang-key="impactUnitJobs">份</span>
          </div>
        </div>
      </div>
    </section>

  </main>

  <footer class="footer-container fade-in-section">
    <div class="footer-banner" id="footer-banner">
      <div class="footer-dark-overlay"></div>
      <div class="footer-overlay">
        <div class="footer-left">
          <h2 data-lang-key="footerSlogan">相信善良<br/>用生命影響生命</h2>
          <p class="footer-subtext" data-lang-key="footerSubtext">善的力量，從這裡開始</p>
        </div>
        <div class="footer-right">
          <button class="contact-btn" id="contact-toggle-btn" aria-controls="contact-info-panel" aria-expanded="false" data-lang-key="footerContactBtn">聯繫我們</button>
        </div>
      </div>
    </div>

    <div id="contact-info-panel" class="contact-info-panel">
      <h3 data-lang-key="footerContactTitle">聯絡方式</h3>
      <p>✉️ email@example.com</p>
      <p>📞 02 2559 0960</p>
      <p>📍 台北市中正區羅斯福路二段168號6號樓之1</p>
    </div>
  </footer>

  <script src="script.js" defer></script>
</body>
</html>
